
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>High Performance Computing &#8212; Chem 193</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=e645c8fa"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'tutorial/hpc';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Neural networks with JAX" href="jax-nn.html" />
    <link rel="prev" title="Linear Regression" href="linear-regression.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">Chem 193</p>
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../schedule.html">Schedule</a></li>
<li class="toctree-l1"><a class="reference internal" href="../syllabus.html">Syllabus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lecture.html">Lecture Slides</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">Tutorials</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="python-basics.html">Python Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="numpy-jax.html">Numpy &amp; JAX</a></li>
<li class="toctree-l2"><a class="reference internal" href="linear-regression.html">Linear Regression</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">High Performance Computing</a></li>
<li class="toctree-l2"><a class="reference internal" href="jax-nn.html">Neural networks with JAX</a></li>
<li class="toctree-l2"><a class="reference internal" href="sample-from-probability-distributions.html">Sample from probability distributions</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../homework/index.html">Homeworks</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../homework/0-linear-algebra.html">Linear Algebra</a></li>
<li class="toctree-l2"><a class="reference internal" href="../homework/1-python-basics/main.html">Protein MSA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../homework/2-protein-secondary-structure/script/main.html">Protein secondary structure</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/DingGroup/Chem-193" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/tutorial/hpc.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>High Performance Computing</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#install-ssh-related-extensions-for-vs-code">Install SSH-related extensions for VS Code</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#add-expanse-to-your-ssh-configuration">Add Expanse to your SSH configuration</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#logging-in-to-expanse">Logging in to Expanse</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#logging-in-to-a-compute-node">Logging in to a compute node</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="high-performance-computing">
<h1>High Performance Computing<a class="headerlink" href="#high-performance-computing" title="Link to this heading">#</a></h1>
<p>For some homework assignments, your laptop or desktop computer may not be powerful enough to run the code in a reasonable amount of time. In these cases, you may want to use a high performance computing (HPC) cluster. This tutorial will show you how to run your code on the HPC cluster <a class="reference external" href="https://www.sdsc.edu/support/user_guides/expanse.html">Expanse</a> at the San Diego Supercomputer Center (SDSC).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This tutorial assumes that your account has been created on Expanse. Here is the full <a class="reference external" href="https://www.sdsc.edu/support/user_guides/expanse.html">Expanse User Guide</a>. We will only need a small subset of the information in this guide, but you may find it useful to refer to the full guide if you have any questions.</p>
</div>
<section id="install-ssh-related-extensions-for-vs-code">
<h2>Install SSH-related extensions for VS Code<a class="headerlink" href="#install-ssh-related-extensions-for-vs-code" title="Link to this heading">#</a></h2>
<p>To log in to Expanse, you will need to use SSH. If you are using Visual Studio Code, you need to install the following extensions:</p>
<ul class="simple">
<li><p>Remote - SSH</p></li>
<li><p>Remote - SSH: Editing Configuration Files</p></li>
<li><p>Remote - Tunnel</p></li>
</ul>
<p>You can install these extensions by clicking on the Extensions icon on the left side of the VS code window, searching for the extension name, and clicking the Install button.</p>
</section>
<section id="add-expanse-to-your-ssh-configuration">
<h2>Add Expanse to your SSH configuration<a class="headerlink" href="#add-expanse-to-your-ssh-configuration" title="Link to this heading">#</a></h2>
<p>To log in to Expanse, you need to add the following lines to your SSH configuration file. This file is located at <cite>~/.ssh/config</cite> on your computer. You could check if the file exists by open your home directory using VS code. If the file does not exist or the folder <cite>~/.ssh</cite> does not exist, create it in your home directory using VS code. Then add the following lines to the file <cite>~/.ssh/config</cite>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Host<span class="w"> </span>expanse
<span class="w">    </span>HostName<span class="w"> </span>login.expanse.sdsc.edu
<span class="w">    </span>User<span class="w"> </span>YOUR_USER_NAME
</pre></div>
</div>
<p>Replace <cite>YOUR_USER_NAME</cite> with your username on Expanse. Save the file and close it.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Your user name on Expanse might be different from your user name on <cite>ACESS</cite>. You can find your user name on Expanse in your ACESS account. After you log in to ACESS, find the page showing your project information. Your user name on Expanse is listed there.</p>
</div>
</section>
<section id="logging-in-to-expanse">
<h2>Logging in to Expanse<a class="headerlink" href="#logging-in-to-expanse" title="Link to this heading">#</a></h2>
<p>After adding Expanse to your SSH configuration, you can log in to Expanse using either the terminal or VS Code.</p>
<p>In a terminal, you could log in to Expanse by running the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ssh<span class="w"> </span>expanse
</pre></div>
</div>
<p>It will ask you for your password. After entering your password, you should be logged in to Expanse.</p>
<p>If you are using VS Code, you can log in to Expanse by clicking on the Remote Explorer icon on the left side of the VS Code window. Then click on the SSH Targets icon at the top of the Remote Explorer window. You should see <cite>expanse</cite> in the list of SSH targets. Click on <cite>expanse</cite> to log in to Expanse.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The node you log in to in the above steps is a login node. You can write your code and move files around on the login node, but you should not run your code on the login node. Instead, you should run your code on a compute node. The following sections will show you how to login to a compute node and run your code.</p>
</div>
</section>
<section id="logging-in-to-a-compute-node">
<h2>Logging in to a compute node<a class="headerlink" href="#logging-in-to-a-compute-node" title="Link to this heading">#</a></h2>
<p>Compute nodes are shared resources on the HPC cluster and are managed by the job scheduler Slurm. To use a compute node, you need to request it from Slurm. When you request a compute node, you can specify the number of CPUs, the amount of memory, and the amount of time you need. The following is an example of how to request a compute node in terminal after you have logged in to a login node:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>srun<span class="w"> </span>--account<span class="o">=</span>tft109<span class="w"> </span>--pty<span class="w"> </span>-p<span class="w"> </span>compute<span class="w"> </span>--nodes<span class="o">=</span><span class="m">1</span><span class="w"> </span>--ntasks-per-node<span class="o">=</span><span class="m">1</span><span class="w"> </span>--mem<span class="o">=</span>1G<span class="w"> </span>--time<span class="o">=</span><span class="m">1</span>:00:00<span class="w"> </span>--wait<span class="o">=</span><span class="m">0</span><span class="w"> </span>--export<span class="o">=</span>ALL<span class="w"> </span>/bin/bash
</pre></div>
</div>
<p>The above command requests a compute node with 1 CPU, 1GB of memory, and 1 hour of time. You can change the values of <cite>–nodes</cite>, <cite>–ntasks-per-node</cite>, <cite>–mem</cite>, and <cite>–time</cite> to request more resources. The <cite>–account</cite> flag specifies the project <cite>tft109</cite> that you are using.</p>
<p>If there are available resources and your request is accepted by Slurm, you will be logged in to a compute node. You can run your code on the compute node.</p>
<p>To request a compute node with a GPU, you can use the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>srun<span class="w"> </span>--account<span class="o">=</span>tft109<span class="w"> </span>--pty<span class="w"> </span>-p<span class="w"> </span>gpu<span class="w"> </span>--gpus<span class="o">=</span><span class="m">1</span><span class="w"> </span>--nodes<span class="o">=</span><span class="m">1</span><span class="w"> </span>--ntasks-per-node<span class="o">=</span><span class="m">1</span><span class="w"> </span>--mem<span class="o">=</span>1G<span class="w"> </span>--time<span class="o">=</span><span class="m">1</span>:00:00<span class="w"> </span>--wait<span class="o">=</span><span class="m">0</span><span class="w"> </span>--export<span class="o">=</span>ALL<span class="w"> </span>/bin/bash
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Please be mindful of the resources you request, as you are sharing the
resources granted to this course with other students in the class. Once your requested resources are granted by Slurm, they are considered used, even if they are not used fully. For example, if you request a compute node with 10 hours of time and only use it for 1 hour, the remaining 9 hours are considered used.</p>
</div>
<p>Now you are assigned a compute node and can run your code on it via the terminal. What if you want to run your code in VS Code? For example, you may want to use the interactive debugger or run a Jupyter notebook in VS Code on the compute node. To do this, you could use ssh tunneling. This requires a few more steps.</p>
<ol class="arabic simple">
<li><p>Copy the vscode command line tool to your directory. You could do this on either the login node or the compute node by running the following command. You only need to do this once.</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">## cope the vscode command to your directory</span>
mkdir<span class="w"> </span>-p<span class="w"> </span>~/apps
cp<span class="w"> </span>/home/xding1/apps/code<span class="w"> </span>~/apps
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You only need to copy the vscode command once. The next time you want to login to a compute node, you can skip this step.</p>
</div>
<ol class="arabic simple" start="2">
<li><p>On a compute node that you have logged in to using the <cite>srun</cite> command, run the following command to start the ssh tunnel:</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>~/apps/code<span class="w"> </span>tunnel
</pre></div>
</div>
<p>This command will ask you what account to use for the tunnel. Select using Github account. It will then provide you with a URL and a passcode. Open the URL in your browser and enter the passcode. It might ask you to log in to your Github account if you are not already logged in. After you enter the passcode, the tunnel should be established.</p>
<ol class="arabic simple" start="3">
<li><p>Open the Remote Explorer in VS Code. Click on the Tunnels icon at the top of the Remote Explorer window. You should see a tunnel with the name of the compute node you are logged in to. Click on the tunnel to open a new VS Code window that is connected to the compute node.</p></li>
</ol>
<p>Now you can run your code in VS Code on the compute node. You can use the interactive debugger, run Jupyter notebooks, and use other features of VS Code.</p>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="linear-regression.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Linear Regression</p>
      </div>
    </a>
    <a class="right-next"
       href="jax-nn.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Neural networks with JAX</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#install-ssh-related-extensions-for-vs-code">Install SSH-related extensions for VS Code</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#add-expanse-to-your-ssh-configuration">Add Expanse to your SSH configuration</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#logging-in-to-expanse">Logging in to Expanse</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#logging-in-to-a-compute-node">Logging in to a compute node</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Xinqiang Ding
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024, Xinqiang Ding.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>